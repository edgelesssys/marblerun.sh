<!doctype html><html><head><title>Quickstart</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://marblerun.sh/docs/getting-started/quickstart/><link rel=stylesheet href=https://marblerun.sh/scss/bootstrap.min.462c371c7334fb8be9e57eb1edffd6d85726378c54b9e9c7135419c4a0a7f0b9.css emotion=ü§©><script defer src=https://use.fontawesome.com/releases/v5.10.2/js/all.js></script><script async defer src=https://buttons.github.io/buttons.js></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><meta property="og:title" content="Marblerun - The control plane for confidential computing"><meta property="og:description" content="Marblerun makes it easy to deploy, scale, and verify your SGX-based apps on vanilla Kubernetes. Think Istio/Consul/Linkerd for confidential computing.‚Äã"><meta property="og:image" content="https://www.marblerun.sh/img/social.png"><meta name=twitter:title content="Marblerun - The control plane for confidential computing"><meta name=twitter:description content="Marblerun makes it easy to deploy, scale, and verify your SGX-based apps on vanilla Kubernetes."><meta name=twitter:image content="https://www.marblerun.sh/img/social.png"><meta name=twitter:card content="Marblerun"></head><body><nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top container-fluid"><a class=navbar-brand href=/><img src=/img/logo.png width=140px></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/docs/introduction/><i class="fas fa-book"></i>&nbsp;Docs</a></li><li class=nav-item><a class=nav-link href=/community><i class="fas fa-comments"></i>&nbsp;Community</a></li><li class=nav-item><a class=nav-link href=https://github.com/edgelesssys/marblerun><i class="fab fa-github"></i>&nbsp;GitHub</a></li><li class=nav-item><a href=/docs/getting-started/quickstart class="nav-link btn btn-primary ml-3">Get started ‚Üí</a></li></ul></div></nav><div class="container my-3"><div class=row><div class="col-12 col-lg-3"><div class=docsSidebar><h1 class=my-3>Docs</h1><div class=mb-3><a href=/docs/introduction/ class=d-block><h6>Introduction</h6></a></div><div class=mb-3><h6 class=cursor-pointer data-toggle=collapse data-target=#collapse1>Getting Started</h6><div class="collapse show" id=collapse1><a href=/docs/getting-started/quickstart/ class="d-block text-primary">> Quickstart</a>
<a href=/docs/getting-started/concepts/ class=d-block>Concepts</a>
<a href=/docs/getting-started/coordinator/ class=d-block>Coordinator</a>
<a href=/docs/getting-started/marbles/ class=d-block>Marbles</a></div></div><div class=mb-3><h6 class=cursor-pointer data-toggle=collapse data-target=#collapse2>Features</h6><div class=collapse id=collapse2><a href=/docs/features/attestation/ class=d-block>Attestation</a>
<a href=/docs/features/recovery/ class=d-block>Recovery</a>
<a href=/docs/features/secrets-management/ class=d-block>Secrets management</a>
<a href=/docs/features/auto-injection/ class=d-block>Kubernetes integration</a>
<a href=/docs/features/runtimes/ class=d-block>Supported runtimes</a>
<a href=/docs/features/planned-features/ class=d-block>Planned features</a></div></div><div class=mb-3><h6 class=cursor-pointer data-toggle=collapse data-target=#collapse3>Deployment</h6><div class=collapse id=collapse3><a href=/docs/deployment/cloud/ class=d-block>Cloud</a>
<a href=/docs/deployment/on-prem/ class=d-block>On-premises</a>
<a href=/docs/deployment/kubernetes/ class=d-block>Kubernetes</a>
<a href=/docs/deployment/standalone/ class=d-block>Standalone</a></div></div><div class=mb-3><h6 class=cursor-pointer data-toggle=collapse data-target=#collapse4>Workflows</h6><div class=collapse id=collapse4><a href=/docs/workflows/define-manifest/ class=d-block>Defining a Manifest</a>
<a href=/docs/workflows/set-manifest/ class=d-block>Setting a Manifest</a>
<a href=/docs/workflows/add-service/ class=d-block>Adding a service</a>
<a href=/docs/workflows/verification/ class=d-block>Verifying a deployment</a>
<a href=/docs/workflows/monitoring/ class=d-block>Monitoring and logging</a>
<a href=/docs/workflows/update-manifest/ class=d-block>Updating a Manifest</a>
<a href=/docs/workflows/updates/ class=d-block>Updating a deployment</a>
<a href=/docs/workflows/recover-coordinator/ class=d-block>Recovering the Coordinator</a></div></div><div class=mb-3><h6 class=cursor-pointer data-toggle=collapse data-target=#collapse5>Building services</h6><div class=collapse id=collapse5><a href=/docs/building-services/ego/ class=d-block>EGo</a>
<a href=/docs/building-services/graphene/ class=d-block>Graphene</a>
<a href=/docs/building-services/occlum/ class=d-block>Occlum</a></div></div><div class=mb-3><a href=/docs/examples/ class=d-block><h6>Examples</h6></a></div><div class=mb-3><h6 class=cursor-pointer data-toggle=collapse data-target=#collapse7>Reference</h6><div class=collapse id=collapse7><a href=/docs/reference/coordinator/ class=d-block>Coordinator API</a>
<a href=/docs/reference/cli/ class=d-block>CLI</a></div></div><div class=mb-3><a href=/docs/changelog/ class=d-block><h6>Changelog</h6></a></div></div></div><div class="col-12 col-lg-9"><article><h1 id=quickstart>Quickstart</h1><p>In this guide, we‚Äôll walk you through how to install Marblerun into your Kubernetes cluster. Then we‚Äôll deploy a sample confidential application to demonstrate the capabilities of Marblerun.</p><p>Installing Marblerun is easy. First, you will install the CLI (command-line interface) onto your local machine. Using this CLI, you‚Äôll then install the control plane onto your Kubernetes cluster.
Finally, you will add your own services and set up a corresponding Manifest.</p><div class=note><p><i class="fa fa-info-circle"></i>&nbsp;<strong>Note</strong></p>A working SGX DCAP environment is required for Marblerun to work. For the ease of exploring and testing we provide a simulation mode with <code>--simulation</code> that runs without SGX hardware.
In this quickstart we deploy Marblerun in simulation mode. Be aware that this is not meant for production and runs without real SGX enclaves.</div><h2 id=step-0-setup>Step 0: Setup</h2><p>First, ensure you have access to a Kubernetes cluster and kubectl installed and configured. Probably the easiest way to get started is to run Kubernetes on your local machine using <a href=https://kubernetes.io/docs/workflows/tools/install-minikube/>Minikube</a>. Another easy way is to use <a href=https://docs.microsoft.com/en-us/azure/aks/kubernetes-walkthrough-portal>Azure Kubernetes Service (AKS)</a>, which offers SGX-enabled nodes.</p><p>You can validate your setup by running:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl version --short
</code></pre></div><p>You should see output with both a Client Version and Server Version component.</p><p>Now your cluster is ready and we‚Äôll install the Marblerun CLI.</p><h2 id=step-1-install-the-cli>Step 1: Install the CLI</h2><p>If this is your first time running Marblerun, you will need to download the marblerun command-line interface (CLI) onto your local machine. The CLI will allow you to interact with your Marblerun deployment.</p><p>To install the CLI manually, run:</p><h3 id=for-the-current-user>For the current user</h3><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>wget -P ~/.local/bin https://github.com/edgelesssys/marblerun/releases/latest/download/marblerun
chmod +x ~/.local/bin/marblerun
</code></pre></div><h3 id=global-install-requires-root>Global install (requires root)</h3><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo wget -O /usr/local/bin/marblerun https://github.com/edgelesssys/marblerun/releases/latest/download/marblerun
sudo chmod +x /usr/local/bin/marblerun
</code></pre></div><p>Once installed, verify the CLI is running correctly with:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>marblerun
</code></pre></div><h2 id=step-2-install-the-control-plane-onto-your-cluster>Step 2: Install the control-plane onto your cluster</h2><p>Now that you have the CLI running locally and a cluster that is ready to go, it‚Äôs time to install the control plane.</p><p>Install Marblerun&rsquo;s <em>Coordinator</em> control-plane by running:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>marblerun install --simulation
</code></pre></div><p>The <code>marblerun install</code> command generates a Kubernetes manifest with all the necessary control plane resources.
The simulation flag tells Marblerun that real SGX hardware might not be present and the SGX-layer should be emulated.</p><p>Wait for the control plane to finish installing:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>marblerun check
</code></pre></div><p>This command will wait until all components of Marblerun are ready to be used or return an error after a timeout period is reached.</p><h2 id=step-3-initialize-and-verify-the-coordinator>Step 3: Initialize and verify the Coordinator</h2><p>After installing the Coordinator we need to verify its integrity.
For this, we utilize SGX remote attestation and obtain the Coordinator&rsquo;s root certificate.</p><ol><li>Port forward the Coordinator&rsquo;s Client API</li></ol><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl -n marblerun port-forward svc/coordinator-client-api 4433:4433 --address localhost &gt;/dev/null &amp;
<span style=color:#366>export</span> <span style=color:#033>MARBLERUN</span><span style=color:#555>=</span>localhost:4433
</code></pre></div><ol><li>Verify the quote and get the coordinator&rsquo;s root certificate</li></ol><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>marblerun certificate root <span style=color:#033>$MARBLERUN</span> -o marblerun.crt --insecure
</code></pre></div><p>The CLI will obtain the coordinator&rsquo;s remote attestation quote and verify it against the configuration on our <a href=github.com/edgelesssys/marblerun/releases/latest/download/coordinator-era.json>release page</a>.
The SGX quote proves the integrity of the coordinator pod.
Since we are not using SGX hardware in this case (<code>--simulation</code>), the quote verification is omitted by marblerun.
The CLI returns a certificate as result and stores it as <code>marblerun.crt</code> in your current directory.
The certificate is bound to the quote and can be used for future verification.
It can also be used as a root of trust for <a href=https://marblerun.sh/docs/features/attestation/#external-attestation-of-the-app>authenticating your confidential applications</a>.</p><h2 id=step-4-deploy-the-demo-application>Step 4: Deploy the demo application</h2><p>To get a feel for how Marblerun would work for one of your services, you can install a demo application.
The emojivoto application is a standalone Kubernetes application that uses a mix of gRPC and HTTP calls to allow the users to vote on their favorite emojis.
Created as a demo application for the popular <a href=https://linkerd.io>Linkerd</a> service mesh, we&rsquo;ve created a confidential variant that uses TLS for all gRPC and HTTP connections.
Clone the demo application from the <a href=https://github.com/edgelesssys/emojivoto.git>GitHub repository</a> by running:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git clone https://github.com/edgelesssys/emojivoto.git <span style=color:#555>&amp;&amp;</span> <span style=color:#366>cd</span> emojivoto
</code></pre></div><p>Marblerun guarantees that the topology of your distributed app adheres to a Manifest specified in simple JSON.
Marblerun verifies the integrity of services, bootstraps them, and sets up encrypted connections between them.
The emojivoto demo already comes with a <a href=https://github.com/edgelesssys/emojivoto/blob/main/tools/manifest.json>manifest</a>, which you can deploy onto Marblerun by running:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>marblerun manifest <span style=color:#366>set</span> tools/manifest.json <span style=color:#033>$MARBLERUN</span> --insecure
</code></pre></div><p>You can check that the state of Marblerun changed and is now ready to authenticate your services by running:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>marblerun status <span style=color:#033>$MARBLERUN</span>
</code></pre></div><p>Create and annotate the emojivoto namespace for <a href=https://marblerun.sh/docs/features/auto-injection/>auto-injection</a>:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl create namespace emojivoto
marblerun namespace add emojivoto --no-sgx-injection
</code></pre></div><p>Finally, install the demo application onto your cluster.
Please make sure you have <a href=https://helm.sh/docs/intro/install/>Helm</a> (&ldquo;the package manager for Kubernetes&rdquo;) installed at least at Version v3.2.0.
Install emojivoto into the emojivoto namespace by running:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>helm install -f ./kubernetes/nosgx_values.yaml emojivoto ./kubernetes --create-namespace -n emojivoto
</code></pre></div><h2 id=step-5-watch-it-run>Step 5: Watch it run</h2><p>You can now check the Marblerun log and see the services being authenticated by the coordinator.</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl -n marblerun logs -f -ledgeless.systems/control-plane-component<span style=color:#555>=</span>coordinator
</code></pre></div><p>Port forward the front-end web service to access it on your local machine by running:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo kubectl -n emojivoto port-forward svc/web-svc 443:443 --address 0.0.0.0
</code></pre></div><p>Now visit <a href=https://localhost>https://localhost</a>.
You&rsquo;ll be presented with a certificate warning because your browser does not know Marblerun&rsquo;s root certificate as a root of trust.
You can safely ignore this error for now and proceed to the website.<br>Voila! Your emoji votes have never been safer!</p><h2 id=thats-it->That‚Äôs it! üëè</h2><p>Congratulations, you‚Äôre now a Marblerun user! Here are some suggested next steps:</p><ul><li>Explore how <a href=https://marblerun.sh/docs/features/secrets-management/>Marblerun takes care of your secrets</a></li><li><a href=https://marblerun.sh/docs/workflows/add-service/>Add your own service</a> to Marblerun</li><li>Learn more about <a href=https://marblerun.sh/docs/getting-started/concepts/>Marblerun‚Äôs architecture</a></li><li>Chat with us on <a href=https://discord.gg/rH8QTH56JN>Discord</a></li></ul><p>Welcome to the Marblerun community!</p></article></div></div></div><footer class="bg-light text-center p-3"><div>Marblerun is brought to you by <a target=_blank href=https://edgeless.systems/>Edgeless Systems GmbH <img src=/img/ES_Symbol_black.svg class="verticle-align-middle ml-2" alt="Edgeless Systems GmbH Logo" width=14px class=mb-3></a></div></footer><script src=https://code.jquery.com/jquery-3.5.1.slim.min.js integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js integrity=sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx crossorigin=anonymous></script><script src=/js/main.js></script></body></html>