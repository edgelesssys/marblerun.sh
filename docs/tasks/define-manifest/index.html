<!doctype html><html><head><title>Defining a Manifest</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://marblerun.sh/docs/tasks/define-manifest/><link rel=stylesheet href=https://marblerun.sh/scss/bootstrap.min.05e88624b497548722fef3538d7efdf80b0045261b068a51fbcf9b25d5fa5298.css emotion=ðŸ¤©><script defer src=https://use.fontawesome.com/releases/v5.10.2/js/all.js></script></head><body><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top container-fluid"><a class=navbar-brand href=/><img src=/img/logo.png width=140px></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/docs/introduction/><i class="fas fa-book"></i>Docs</a></li><li class=nav-item><a class=nav-link href=/community><i class="fas fa-comments"></i>Community</a></li><li class=nav-item><a class=nav-link href=https://github.com/edgelesssys/marblerun><i class="fab fa-github"></i>Github</a></li><li class=nav-item><a href=/docs/getting-started/quickstart class="nav-link btn btn-primary ml-3">Get started â†’</a></li></ul></div></nav><div class="container my-3"><div class=mb-3><div id=breadcrumbs><a href=/>Home</a>
/ <a href=/docs>Docs</a>
/ <a href=/tasks>Tasks</a>
/ <a href=/define-manifest>Define manifest</a></div></div><h1 class=my-3>Docs</h1><div class=row><div class="col-12 col-lg-3"><div class=docsSidebar><div class=mb-3><a href=https://marblerun.sh/docs/introduction/ class=d-block>Introduction</a></div><div class=mb-3><h6>Getting Started</h6><a href=https://marblerun.sh/docs/getting-started/quickstart/ class="d-block pl-3">Quickstart</a>
<a href=https://marblerun.sh/docs/getting-started/concepts/ class="d-block pl-3">Concepts</a>
<a href=https://marblerun.sh/docs/getting-started/coordinator/ class="d-block pl-3">Coordinator</a>
<a href=https://marblerun.sh/docs/getting-started/marbles/ class="d-block pl-3">Marbles</a></div><div class=mb-3><h6>Features</h6><a href=https://marblerun.sh/docs/features/attestation/ class="d-block pl-3">Attestation</a>
<a href=https://marblerun.sh/docs/features/recovery/ class="d-block pl-3">Recovery</a>
<a href=https://marblerun.sh/docs/features/secrets-management/ class="d-block pl-3">Secrets management</a>
<a href=https://marblerun.sh/docs/features/planned-features/ class="d-block pl-3">Planned features</a></div><div class=mb-3><h6>Tasks</h6><a href=https://marblerun.sh/docs/tasks/deploy/ class="d-block pl-3">Deploying Marblerun</a>
<a href=https://marblerun.sh/docs/tasks/define-manifest/ class="d-block pl-3">Defining a Manifest</a>
<a href=https://marblerun.sh/docs/tasks/set-manifest/ class="d-block pl-3">Setting a Manifest</a>
<a href=https://marblerun.sh/docs/tasks/add-service/ class="d-block pl-3">Adding a service</a>
<a href=https://marblerun.sh/docs/tasks/verification/ class="d-block pl-3">Verifying a deployment</a>
<a href=https://marblerun.sh/docs/tasks/monitoring/ class="d-block pl-3">Monitoring and logging</a>
<a href=https://marblerun.sh/docs/tasks/updates/ class="d-block pl-3">Updating a deployment</a>
<a href=https://marblerun.sh/docs/tasks/recover-coordinator/ class="d-block pl-3">Recovering the Coordinator</a></div><div class=mb-3><h6>Examples</h6><a href=https://marblerun.sh/docs/examples/helloworld/ class="d-block pl-3">Hello World</a>
<a href=https://marblerun.sh/docs/examples/emojivoto/ class="d-block pl-3">Confidential Emoji Voting</a></div><div class=mb-3><a href=https://marblerun.sh/docs/changelog/ class=d-block>Changelog</a></div></div></div><div class="col-12 col-lg-9"><article><h1 id=defining-a-manifest>Defining a Manifest</h1><p>The Manifest is a simple JSON file that determines the key properties of your cluster: <code>Packages</code>, <code>Infrastructures</code>, <code>Marbles</code>, and <code>RecoveryKey</code>.
This article describes how to define these in your <code>manifest.json</code>.</p><h2 id=manifestpackages>Manifest:Packages</h2><p>A package defines a specific container image in your application.
It contains the secure enclave&rsquo;s measurements and associated properties:</p><ul><li><strong>UniqueID</strong>: The enclave&rsquo;s unique identifying measurement, called MRENCLAVE on SGX</li><li><strong>SignerID</strong>: The signer&rsquo;s unique identifier, called MRSIGNER on SGX</li><li><strong>ProductID</strong>: The unique identifier of your product associated with the enclave</li><li><strong>SecurityVersion</strong>: The version number of your product associated with the enclave</li><li><strong>Debug</strong>: A flag indicating whether your enclave should be run in debug mode</li></ul><p>You can use any combination of these values depending on how you want to identify the image.
For each confidential container you want to run in your cluster, you need to add an entry in the <em>Packages</em> section of the Manifest.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
    <span style=color:#75715e>// ...
</span><span style=color:#75715e></span>    <span style=color:#e6db74>&#34;Packages&#34;</span><span style=color:#f92672>:</span> {
        <span style=color:#e6db74>&#34;backend&#34;</span><span style=color:#f92672>:</span> {
            <span style=color:#e6db74>&#34;UniqueID&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f&#34;</span>,
            <span style=color:#e6db74>&#34;ProductID&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>42</span>,
            <span style=color:#e6db74>&#34;SecurityVersion&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
            <span style=color:#e6db74>&#34;Debug&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>
        },
        <span style=color:#e6db74>&#34;frontend&#34;</span><span style=color:#f92672>:</span> {
            <span style=color:#e6db74>&#34;SignerID&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;c0ffeec0ffeec0ffeec0ffeec0ffeec0ffeec0ffeec0ffeec0ffeec0ffeec0ffee&#34;</span>,
            <span style=color:#e6db74>&#34;ProductID&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>43</span>,
            <span style=color:#e6db74>&#34;SecurityVersion&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>,
            <span style=color:#e6db74>&#34;Debug&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>
        }
    }
    <span style=color:#75715e>// ...
</span><span style=color:#75715e></span>}
</code></pre></div><h2 id=manifestmarbles>Manifest:Marbles</h2><p>Marbles represent the actual services in your mesh. They are defined in the <em>Marbles</em> section. Each Marble corresponds to a <code>Package</code> and defines a set of optional <code>Parameters</code>:</p><ul><li>Files: Files and their contents</li><li>Env: Environment variables</li><li>Argv: Command line arguments</li></ul><p>These <code>Parameters</code> are passed from the Coordinator to secure enclaves after successful initial remote attestation. <code>Parameters</code> can contain the following placeholders:</p><ul><li><code>$$root_ca</code>: The root certificate of the cluster issued by the Coordinator; it can be used to verify the certificates of all Marbles in the cluster.</li><li><code>$$marble_cert</code>: The Marble&rsquo;s certificate; issued by the Coordinator and used for Marble-to-Marble and Marble-to-client authentication</li><li><code>$$marble_key</code>: The private key corresponding to <code>$$marble_cert</code></li><li><code>$$seal_key</code>: A 128-bit symmetric encryption key that can be used for sealing data to disk in a host-independent way; if a Marble is scheduled or restarted on a new host, this &ldquo;virtual sealing key&rdquo; will still allow for unsealing data from the disk even though the host&rsquo;s actual sealing key might have changed.</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
    <span style=color:#75715e>// ...
</span><span style=color:#75715e></span>    <span style=color:#e6db74>&#34;Marbles&#34;</span><span style=color:#f92672>:</span> {
        <span style=color:#e6db74>&#34;backend_first&#34;</span><span style=color:#f92672>:</span> {
            <span style=color:#e6db74>&#34;Package&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;backend&#34;</span>,
            <span style=color:#e6db74>&#34;MaxActivations&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
            <span style=color:#e6db74>&#34;Parameters&#34;</span><span style=color:#f92672>:</span> {
                <span style=color:#e6db74>&#34;Files&#34;</span><span style=color:#f92672>:</span> {
                    <span style=color:#e6db74>&#34;/tmp/defg.txt&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;foo&#34;</span>,
                    <span style=color:#e6db74>&#34;/tmp/jkl.mno&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;bar&#34;</span>
                },
                <span style=color:#e6db74>&#34;Env&#34;</span><span style=color:#f92672>:</span> {
                    <span style=color:#e6db74>&#34;IS_FIRST&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;true&#34;</span>,
                    <span style=color:#e6db74>&#34;ROOT_CA&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;$$root_ca&#34;</span>,
                    <span style=color:#e6db74>&#34;SEAL_KEY&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;$$seal_key&#34;</span>,
                    <span style=color:#e6db74>&#34;MARBLE_CERT&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;$$marble_cert&#34;</span>,
                    <span style=color:#e6db74>&#34;MARBLE_KEY&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;$$marble_key&#34;</span>
                },
                <span style=color:#e6db74>&#34;Argv&#34;</span><span style=color:#f92672>:</span> [
                    <span style=color:#e6db74>&#34;--first&#34;</span>,
                    <span style=color:#e6db74>&#34;serve&#34;</span>
                ]
            }
        },
        <span style=color:#e6db74>&#34;frontend&#34;</span><span style=color:#f92672>:</span> {
            <span style=color:#e6db74>&#34;Package&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;frontend&#34;</span>,
            <span style=color:#e6db74>&#34;Parameters&#34;</span><span style=color:#f92672>:</span> {
                <span style=color:#e6db74>&#34;Env&#34;</span><span style=color:#f92672>:</span> {
                    <span style=color:#e6db74>&#34;ROOT_CA&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;$$root_ca&#34;</span>,
                    <span style=color:#e6db74>&#34;SEAL_KEY&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;$$seal_key&#34;</span>,
                    <span style=color:#e6db74>&#34;MARBLE_CERT&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;$$marble_cert&#34;</span>,
                    <span style=color:#e6db74>&#34;MARBLE_KEY&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;$$marble_key&#34;</span>
                }
            }
        }
    }
    <span style=color:#75715e>//...
</span><span style=color:#75715e></span>}
</code></pre></div><h2 id=manifestrecoverykey>Manifest:RecoveryKey</h2><p>The optional entry <code>RecoveryKey</code> holds a X.509 PEM-encoded RSA public key, which can be used to recover a failed Marblerun deployment, as is described <a href=https://marblerun.sh/docs/features/recovery/>here</a>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
    <span style=color:#75715e>//...
</span><span style=color:#75715e></span>    <span style=color:#e6db74>&#34;RecoveryKey&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;-----BEGIN PUBLIC KEY-----\nMIIBpTANBgk...&#34;</span>
}
</code></pre></div><p>This key can be generated with the help of OpenSSL.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openssl genrsa -out private_key.pem <span style=color:#ae81ff>4096</span>
openssl rsa -in private_key.pem -outform PEM -pubout -out public_key.pem
</code></pre></div><p>To preserve the new lines correctly, you can use the following command:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>awk <span style=color:#e6db74>&#39;NF {sub(/\r/, &#34;&#34;); printf &#34;%s\\n&#34;,$0;}&#39;</span> public_key.pem
</code></pre></div><h2 id=manifestinfrastructures>Manifest:Infrastructures</h2><p>Future versions of Marblerun will allow you to define certain trusted infrastructures and hardware configurations under <code>Infrastructures</code>.</p></article></div></div></div><footer class="bg-light text-center p-3"><div>Marblerun is brought to you by <a target=_blank href=https://edgeless.systems/>Edgeless Systems GmbH <img src=/img/ES_Symbol_black.svg class="verticle-align-middle ml-2" alt="Edgeless Systems GmbH Logo" width=14px class=mb-3></a></div></footer><script src=https://code.jquery.com/jquery-3.5.1.slim.min.js integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js integrity=sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx crossorigin=anonymous></script><script src=/js/main.js></script></body></html>