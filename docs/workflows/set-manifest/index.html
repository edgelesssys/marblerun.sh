<!doctype html><html><head><title>Setting a Manifest</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://marblerun.sh/docs/workflows/set-manifest/><link rel=stylesheet href=https://marblerun.sh/scss/bootstrap.min.462c371c7334fb8be9e57eb1edffd6d85726378c54b9e9c7135419c4a0a7f0b9.css emotion=ðŸ¤©><script defer src=https://use.fontawesome.com/releases/v5.10.2/js/all.js></script><script async defer src=https://buttons.github.io/buttons.js></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><meta property="og:title" content="Marblerun - The control plane for confidential computing"><meta property="og:description" content="Marblerun makes it easy to deploy, scale, and verify your SGX-based apps on vanilla Kubernetes. Think Istio/Consul/Linkerd for confidential computing.â€‹"><meta property="og:image" content="https://www.marblerun.sh/img/social.png"><meta name=twitter:title content="Marblerun - The control plane for confidential computing"><meta name=twitter:description content="Marblerun makes it easy to deploy, scale, and verify your SGX-based apps on vanilla Kubernetes."><meta name=twitter:image content="https://www.marblerun.sh/img/social.png"><meta name=twitter:card content="Marblerun"></head><body><nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top container-fluid"><a class=navbar-brand href=/><img src=/img/logo.png width=140px></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/docs/introduction/><i class="fas fa-book"></i>&nbsp;Docs</a></li><li class=nav-item><a class=nav-link href=/community><i class="fas fa-comments"></i>&nbsp;Community</a></li><li class=nav-item><a class=nav-link href=https://github.com/edgelesssys/marblerun><i class="fab fa-github"></i>&nbsp;GitHub</a></li><li class=nav-item><a href=/docs/getting-started/quickstart class="nav-link btn btn-primary ml-3">Get started â†’</a></li></ul></div></nav><div class="container my-3"><div class=row><div class="col-12 col-lg-3"><div class=docsSidebar><h1 class=my-3>Docs</h1><div class=mb-3><a href=/docs/introduction/ class=d-block><h6>Introduction</h6></a></div><div class=mb-3><h6 class=cursor-pointer data-toggle=collapse data-target=#collapse1>Getting Started</h6><div class=collapse id=collapse1><a href=/docs/getting-started/quickstart/ class=d-block>Quickstart</a>
<a href=/docs/getting-started/concepts/ class=d-block>Concepts</a>
<a href=/docs/getting-started/coordinator/ class=d-block>Coordinator</a>
<a href=/docs/getting-started/marbles/ class=d-block>Marbles</a>
<a href=/docs/getting-started/cli/ class=d-block>CLI</a></div></div><div class=mb-3><h6 class=cursor-pointer data-toggle=collapse data-target=#collapse2>Features</h6><div class=collapse id=collapse2><a href=/docs/features/attestation/ class=d-block>Attestation</a>
<a href=/docs/features/recovery/ class=d-block>Recovery</a>
<a href=/docs/features/secrets-management/ class=d-block>Secrets management</a>
<a href=/docs/features/auto-injection/ class=d-block>Kubernetes integration</a>
<a href=/docs/features/runtimes/ class=d-block>Supported runtimes</a>
<a href=/docs/features/planned-features/ class=d-block>Planned features</a></div></div><div class=mb-3><h6 class=cursor-pointer data-toggle=collapse data-target=#collapse3>Deployment</h6><div class=collapse id=collapse3><a href=/docs/deployment/cloud/ class=d-block>Cloud</a>
<a href=/docs/deployment/on-prem/ class=d-block>On-premises</a>
<a href=/docs/deployment/kubernetes/ class=d-block>Kubernetes</a>
<a href=/docs/deployment/standalone/ class=d-block>Standalone</a></div></div><div class=mb-3><h6 class=cursor-pointer data-toggle=collapse data-target=#collapse4>Core workflows</h6><div class="collapse show" id=collapse4><a href=/docs/workflows/define-manifest/ class=d-block>Defining a Manifest</a>
<a href=/docs/workflows/set-manifest/ class="d-block text-primary">> Setting a Manifest</a>
<a href=/docs/workflows/add-service/ class=d-block>Adding a service</a>
<a href=/docs/workflows/verification/ class=d-block>Verifying a deployment</a></div></div><div class=mb-3><h6 class=cursor-pointer data-toggle=collapse data-target=#collapse5>Additional workflows</h6><div class=collapse id=collapse5><a href=/docs/additional-workflows/monitoring/ class=d-block>Monitoring and logging</a>
<a href=/docs/additional-workflows/update-manifest/ class=d-block>Updating a Manifest</a>
<a href=/docs/additional-workflows/updates/ class=d-block>Updating a deployment</a>
<a href=/docs/additional-workflows/recover-coordinator/ class=d-block>Recovering the Coordinator</a></div></div><div class=mb-3><h6 class=cursor-pointer data-toggle=collapse data-target=#collapse6>Building services</h6><div class=collapse id=collapse6><a href=/docs/building-services/ego/ class=d-block>EGo</a>
<a href=/docs/building-services/graphene/ class=d-block>Graphene</a>
<a href=/docs/building-services/occlum/ class=d-block>Occlum</a></div></div><div class=mb-3><a href=/docs/examples/ class=d-block><h6>Examples</h6></a></div><div class=mb-3><a href=/docs/changelog/ class=d-block><h6>Changelog</h6></a></div></div></div><div class="col-12 col-lg-9"><article><h1 id=setting-a-manifest>Setting a Manifest</h1><p>The Manifest is a JSON document that defines which services span the mesh and how they should be configured.
It further defines what Infrastructure providers are allowed.
You can set a Manifest through Marblerun&rsquo;s Client REST-API.
The endpoint for all Manifest operations is <code>/manifest</code>.</p><p>See the following Manifest for example (<code>manifest.json</code>).</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
    <span style=color:#309;font-weight:700>&#34;Packages&#34;</span>: {
        <span style=color:#309;font-weight:700>&#34;backend&#34;</span>: {
            <span style=color:#309;font-weight:700>&#34;UniqueID&#34;</span>: <span style=color:#c30>&#34;6b2822ac2585040d4b9397675d54977a71ef292ab5b3c0a6acceca26074ae585&#34;</span>,
            <span style=color:#309;font-weight:700>&#34;ProductID&#34;</span>: <span style=color:#f60>43</span>,
            <span style=color:#309;font-weight:700>&#34;SecurityVersion&#34;</span>: <span style=color:#f60>1</span>,
            <span style=color:#309;font-weight:700>&#34;Debug&#34;</span>: <span style=color:#069;font-weight:700>false</span>
        },
        <span style=color:#309;font-weight:700>&#34;frontend&#34;</span>: {
            <span style=color:#309;font-weight:700>&#34;SignerID&#34;</span>: <span style=color:#c30>&#34;43361affedeb75affee9baec7e054a5e14883213e5a121b67d74a0e12e9d2b7a&#34;</span>,
            <span style=color:#309;font-weight:700>&#34;ProductID&#34;</span>: <span style=color:#f60>42</span>,
            <span style=color:#309;font-weight:700>&#34;SecurityVersion&#34;</span>: <span style=color:#f60>3</span>,
            <span style=color:#309;font-weight:700>&#34;Debug&#34;</span>: <span style=color:#069;font-weight:700>true</span>
        }
    },
    <span style=color:#309;font-weight:700>&#34;Marbles&#34;</span>: {
        <span style=color:#309;font-weight:700>&#34;backend_first&#34;</span>: {
            <span style=color:#309;font-weight:700>&#34;Package&#34;</span>: <span style=color:#c30>&#34;backend&#34;</span>,
            <span style=color:#309;font-weight:700>&#34;MaxActivations&#34;</span>: <span style=color:#f60>1</span>,
            <span style=color:#309;font-weight:700>&#34;Parameters&#34;</span>: {
                <span style=color:#309;font-weight:700>&#34;Files&#34;</span>: {
                    <span style=color:#309;font-weight:700>&#34;/tmp/defg.txt&#34;</span>: <span style=color:#c30>&#34;foo&#34;</span>,
                    <span style=color:#309;font-weight:700>&#34;/tmp/jkl.mno&#34;</span>: <span style=color:#c30>&#34;bar&#34;</span>
                },
                <span style=color:#309;font-weight:700>&#34;Env&#34;</span>: {
                    <span style=color:#309;font-weight:700>&#34;IS_FIRST&#34;</span>: <span style=color:#c30>&#34;true&#34;</span>,
                    <span style=color:#309;font-weight:700>&#34;ROOT_CA&#34;</span>: <span style=color:#c30>&#34;{{ pem .Marblerun.RootCA.Cert }}&#34;</span>,
                    <span style=color:#309;font-weight:700>&#34;SEAL_KEY&#34;</span>: <span style=color:#c30>&#34;{{ hex .Marblerun.SealKey }}&#34;</span>,
                    <span style=color:#309;font-weight:700>&#34;MARBLE_CERT&#34;</span>: <span style=color:#c30>&#34;{{ pem .Marblerun.MarbleCert.Cert }}&#34;</span>,
                    <span style=color:#309;font-weight:700>&#34;MARBLE_KEY&#34;</span>: <span style=color:#c30>&#34;{{ pem .Marblerun.MarbleCert.Private }}&#34;</span>
                },
                <span style=color:#309;font-weight:700>&#34;Argv&#34;</span>: [
                    <span style=color:#c30>&#34;--first&#34;</span>,
                    <span style=color:#c30>&#34;serve&#34;</span>
                ]
            }
        },
        <span style=color:#309;font-weight:700>&#34;backend_other&#34;</span>: {
            <span style=color:#309;font-weight:700>&#34;Package&#34;</span>: <span style=color:#c30>&#34;backend&#34;</span>,
            <span style=color:#309;font-weight:700>&#34;Parameters&#34;</span>: {
                <span style=color:#309;font-weight:700>&#34;Env&#34;</span>: {
                    <span style=color:#309;font-weight:700>&#34;ROOT_CA&#34;</span>: <span style=color:#c30>&#34;{{ pem .Marblerun.RootCA.Cert }}&#34;</span>,
                    <span style=color:#309;font-weight:700>&#34;SEAL_KEY&#34;</span>: <span style=color:#c30>&#34;{{ hex .Marblerun.SealKey }}&#34;</span>,
                    <span style=color:#309;font-weight:700>&#34;MARBLE_CERT&#34;</span>: <span style=color:#c30>&#34;{{ pem .Marblerun.MarbleCert.Cert }}&#34;</span>,
                    <span style=color:#309;font-weight:700>&#34;MARBLE_KEY&#34;</span>: <span style=color:#c30>&#34;{{ pem .Marblerun.MarbleCert.Private }}&#34;</span>
                },
                <span style=color:#309;font-weight:700>&#34;Argv&#34;</span>: [
                    <span style=color:#c30>&#34;serve&#34;</span>
                ]
            }
        },
        <span style=color:#309;font-weight:700>&#34;frontend&#34;</span>: {
            <span style=color:#309;font-weight:700>&#34;Package&#34;</span>: <span style=color:#c30>&#34;frontend&#34;</span>,
            <span style=color:#309;font-weight:700>&#34;Parameters&#34;</span>: {
                <span style=color:#309;font-weight:700>&#34;Env&#34;</span>: {
                    <span style=color:#309;font-weight:700>&#34;ROOT_CA&#34;</span>: <span style=color:#c30>&#34;{{ pem .Marblerun.RootCA.Cert }}&#34;</span>,
                    <span style=color:#309;font-weight:700>&#34;SEAL_KEY&#34;</span>: <span style=color:#c30>&#34;{{ hex .Marblerun.SealKey }}&#34;</span>,
                    <span style=color:#309;font-weight:700>&#34;MARBLE_CERT&#34;</span>: <span style=color:#c30>&#34;{{ pem .Marblerun.MarbleCert.Cert }}&#34;</span>,
                    <span style=color:#309;font-weight:700>&#34;MARBLE_KEY&#34;</span>: <span style=color:#c30>&#34;{{ pem .Marblerun.MarbleCert.Private }}&#34;</span>
                }
            }
        }
    },
    <span style=color:#309;font-weight:700>&#34;RecoveryKeys&#34;</span>:
    {
        <span style=color:#309;font-weight:700>&#34;recoveryKey1:&#34;</span> <span style=color:#c30>&#34;-----BEGIN PUBLIC KEY-----\nMIIBpTANBgkqhkiG9w0BAQEFAAOCAZIAMIIBjQKCAYQAyokHE545y3lU4xsxrqXJ\n58jiaXN8yEdjjuKk0903zMT+FV62UeX17BQhrtdOIf4l4/V/xipqI+osAHBQpRY1\nwM1NCIFFlXUQGgXdtoWiAS7zfFKC+mNlB63Z0Z/50Iw9pl6AFWBQ+16lfmsPMnIu\nLHf4AL3KXVlpgPn6cmRfUoDBx6ITm2QrCDFlVu4j4isgnaZrw6VD0V+G9Mcpgs/0\n0XNmz72eMULfuW+4ULJI9Fx88wiNWWHeSI4vz83ylM5+1QntFROSYWBjgmCnm25j\nKbzV765CVTIU3qq3qkYmclpHfKKt7/TOgVOauvkMCYXyLJkSd1LGLIctWK8tCs1K\nnB237nNg+dZ67Zz9lBYKfNnFoudoc85+vXBRKIfV56FXiXrB32hF1DEj11viMPUr\nroMokLFtDCoAk0Xok4AFQDOgxTw7F8cHskjIYWVCmCqmDUI+FGttyVrc5YLSHAuR\nxQ2oxD0F44JXwxDc/C+OYzOApYl25rmR2nuqioDGpL6/ELRRAgMBAAE=\n-----END PUBLIC KEY-----\n&#34;</span>
    }
}
</code></pre></div><p>To set the manifest we can use the command line interface, which automatically performs remote attestation before uploading the manifest.</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>marblerun manifest <span style=color:#366>set</span> manifest.json <span style=color:#033>$MARBLERUN</span>
</code></pre></div><p>If the Manifest contains a <code>RecoveryKeys</code> entry, you will receive a JSON reply including a recovery secret, encrypted with the public key supplied in <code>RecoveryKeys</code>. The reply will look like this, with <code>[base64]</code> as your encrypted recovery secret.</p><p><code>{"EncryptionKey":"[base64]"}</code></p><div class=alert><p><i class="fas fa-exclamation-triangle"></i>&nbsp;<strong>Attention</strong></p>It is important that you keep this value stored somewhere safe. Without it, you will not be able to perform a recovery step in case the SGX seal key changed.</p></div></article></div></div></div><footer class="bg-light text-center p-3"><div>Marblerun is brought to you by <a target=_blank href=https://edgeless.systems/>Edgeless Systems GmbH <img src=/img/ES_Symbol_black.svg class="verticle-align-middle ml-2" alt="Edgeless Systems GmbH Logo" width=14px class=mb-3></a></div></footer><script src=https://code.jquery.com/jquery-3.5.1.slim.min.js integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js integrity=sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx crossorigin=anonymous></script><script src=/js/main.js></script></body></html>